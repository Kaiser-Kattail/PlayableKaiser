namespace = pki_menu

country_event = {
	id = pki_menu.0
	title = "pki_menu.0.name"
	desc = "pki_menu.0.desc"

	is_triggered_only = yes
	
	show_sound = event_radio_chatter
	picture = GFX_evt_voting

	immediate = {
		start_situation = {
			type = situation_world_tension
			target = root
			effect = {
				save_event_target_as = world_tension_sit
			}
		}
		event_target:world_tension_sit = {
			set_situation_approach = approach_ignore
		}
		set_country_flag = pki_menu_formed
	}
	option = {
		name = "pki_menu.0.a"
		hidden_effect = {
			country_event = { id = pki_menu.1 }
		}
	}
}

country_event = {
	id = pki_menu.1
	title = "pki_menu.1.name"
	desc = "pki_menu.1.desc"

	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = douclaw
		room = "flusion_katown_room"
	}

	immediate = {
		set_country_flag = pki_menu_opened
	}

	option = {
		default_hide_option = yes
		name = "pki_menu.1.a"
		custom_tooltip = "pki_menu.1.a.tooltip"
		hidden_effect = {
			pki_clear_gui_flags = yes
			set_country_flag = pki_conquest_map_tab
			set_country_flag = pki_focus_tree_tab_state
			country_event = { id = pki_menu.2 }
		}
	}
}

country_event = {
	id = pki_menu.2
	title = "pki_menu.2.name"

	diplomatic = yes
	custom_gui = "pki_menu"
	is_triggered_only = yes

	trigger = {
		NOT = { has_country_flag = conquest_map_active }
	}

	immediate = {
		set_country_flag = conquest_map_active
	}

	picture_event_data = {
		portrait = douclaw
		room = "flusion_katown_room"
	}

	option = {
		name = EXIT
		hidden_effect = {
			remove_country_flag = conquest_map_active
		}
	}
}

country_event = {
	id = pki_menu.3
	title = "pki_menu.3.name"

	diplomatic = yes
	custom_gui = "focus_confirm_screen"
	is_triggered_only = yes

	immediate = {
		set_country_flag = pki_selected_focus
	}

	desc = pki_focus_desc_text

	option = {
		name = pki_confirm
		custom_gui = "pki_focus_confirm"
		default_hide_option = no
		hidden_effect = {
			start_situation = {
				type = situation_naitonal_focus
				effect = {
					owner = {
						switch = {
							trigger = has_country_flag
							inline_script = {
								script = pki_focuses/pki_focuses
								PART = situation
							}
						}
					}
				}
			}
		}
	}

	option = {
		name = pki_cancel
		custom_gui = "pki_focus_confirm"
		default_hide_option = yes
		remove_country_flag = pki_selected_focus
		switch = {
			trigger = has_country_flag
			inline_script = {
				script = pki_focuses/pki_focuses
				PART = situation
			}
		}
	}
}